

# Accuracy of speed estimation using simulations

## Spatial Lambda-Fleming-Viot 

Directory `slfv` contains configuration and data files for datasets simulated using
the Spatial Lambda-Fleming-Viot process.

### Data simulation

In order to generate synthetic data sets under the spatial Lambda-Fleming-Viot process,
we used `phyrexsim`, which can be obtained by compiling PhyML code using `./configure --enable-phyrexsim`. From the current `simulations_speed_estimation` repository, do:

```
git clone git@github.com:stephaneguindon/phyml.git;
cd phyml;
sh ./autogen.sh;
./configure --enable-phyrexsim;
make;
cd ..;
mv phyml/src/phyrexsim phyrexsim;
```
The script `datagen.pl` then runs `phyrexsim` to produce the synthetic data:
```
perl ./datagen.pl
```
This produces `.xml`, sequence and coordinate files in the current folder. These files are already provided here for convenience.

### Data analysis

All simulated data sets were then processed with PhyREX on a computer server using `perl sim_ibm.pl`.
The script requires a working installation of PhyREX.

Finally, scatter plots of speed estimates vs. true values and MSE vs. true values were generated by running the `postprocessslfv.R` file in R.


## `nosoi` ebola

Directory `ebola` contains simulation and analyses for datasets simulated using
the [`nosoi`](https://github.com/slequime/nosoi) package, which is an 
agent-based stochastic transmission chain/epidemic simulator

### Data simulation

File `simulations_ebola_nosoi.R` uses the `nosoi` package to simulate datasets
that are inspired by the Ebola epidemics.
It uses a setting similar to the one provided in
[nosoi tutorial](https://slequime.github.io/nosoi/articles/examples/ebola.html).

The agent based simulation generates a transmission tree and continuous localisations.
Sequences were then simulated using a Kimura two parameters model.

The script uses a raster of African population density, that is downloaded from 
[here](https://github.com/slequime/nosoi/raw/master/docs/articles/examples/Africa_pop_2015.tif.zip).
The data produced goes in the `data_ebola` directory.

### Data analysis

All XML files can be processed using the same approach as for the spatial Lambda-Fleming-Viot data sets, i.e., using `perl sim_ibm.pl`. Scatter plots of speed estimates vs. true values and MSE vs. true values were generated by running the `postprocessnosoi.R` file in R.

