
# Cross-validation of locations on WNV data set

## Data

Original data set consists in 801 geo-referenced sequences available from [here](https://github.com/sdellicour/wnv_north_america/blob/master/Scripts_%26_data/Continuous_phylogeographic_analyses/WNV_RRW_tree_1.xml).
It is copied here as file `WNV_RRW_tree_1.xml` for convenience.

## Selection of cross validated locations

150 sequences were selected uniformly at random from the 801 sequence data set using the `wnvcv` program.
`wnvcv` is part of the PhyML package. It is obtained by compiling PhyML using the following steps,
starting from the `crossvalidation` repository:

```
git clone git@github.com:stephaneguindon/phyml.git;
cd phyml;
git checkout wnvcv;
sh ./autogen.sh;
./configure --enable-test;
make;
cd ..;
mv phyml/src/test wnvcv;
```
The sequences are then selected using:
```
./wnvcv --xml=./WNV_RRW_tree_1.xml 2077 150
```

Running `wnvcv` using the command above generates a XML configuration file,
a sequence alignment file and a coordinates file.

The following `R` script then reformat the `xml` file to fit the IBM, IOU and RRW
models, producing files: `wnv_config_ibm.xml`, `wnv_config_iou.xml` and `wnv_config_rrw.xml`:
```
Rscript generate_xml.R
```
Manually edit the XML files hence generated by replacing `phyrex run.id="ibm"` with distinct `run.id` values so as to avoid overwriting output files in further analyses. 

## Cross validation analysis


Run the cross validation analyses using the command-lines below. Make sure to redirect the standard output of the analyses so as to fetch the results of the cross validation analysis in the next step.
```
./phyrex --xml=wnv_config_ibm.xml > ibm.out;
./phyrex --xml=wnv_config_iou.xml > iou.out;
./phyrex --xml=wnv_config_rrw.xml > rrw.out;
```

Postprocess the standard output files of PhyREX analysis:
```
grep CV ibm.out > ibm.bkp;
grep CV iou.out > iou.bkp;
grep CV rrw.out > rrw.bkp;
```

Distributions of distances between estimated and true locations were then plotted using `postprocesscv.R`.

